# PGW (Packet Gateway) üöÄ

![C++](https://img.shields.io/badge/C++-17-blue.svg)
![CMake](https://img.shields.io/badge/CMake-3.16+-brightgreen.svg)
![License](https://img.shields.io/badge/License-MIT-green.svg)
![Tests](https://img.shields.io/badge/Tests-13_passed-success.svg)
![Performance](https://img.shields.io/badge/Performance-154_req/s-orange.svg)

–£–ø—Ä–æ—â–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å —Å–µ—Ç–µ–≤–æ–≥–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ PGW, —Å–ø–æ—Å–æ–±–Ω–∞—è –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å UDP-–∑–∞–ø—Ä–æ—Å—ã, —É–ø—Ä–∞–≤–ª—è—Ç—å —Å–µ—Å—Å–∏—è–º–∏ –∞–±–æ–Ω–µ–Ω—Ç–æ–≤, –≤–µ—Å—Ç–∏ CDR-–∂—É—Ä–Ω–∞–ª –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—Ç—å HTTP API.

## –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- **UDP-–æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∑–∞–ø—Ä–æ—Å–æ–≤** —Å IMSI –∞–±–æ–Ω–µ–Ω—Ç–æ–≤
- **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Å—Å–∏—è–º–∏** —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π —á–µ—Ä–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞
- **CDR-–∂—É—Ä–Ω–∞–ª–∏—Ä–æ–≤–∞–Ω–∏–µ** –≤ —Ñ–æ—Ä–º–∞—Ç–µ: timestamp, IMSI, action
- **HTTP API** —Å —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞–º–∏:
  - `/check_subscriber` - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ —Å–µ—Å—Å–∏–∏
  - `/stop` - –≥—Ä–∞—Ü–∏–æ–∑–Ω–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã
- **–ú–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞** –∑–∞–ø—Ä–æ—Å–æ–≤
- **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ JSON-—Ñ–∞–π–ª—ã**
- **–ü–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** —Å —Ä–∞–∑–Ω—ã–º–∏ —É—Ä–æ–≤–Ω—è–º–∏
- **–ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã** —Å –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º–æ–π —Å–∫–æ—Ä–æ—Å—Ç—å—é

## üìä –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –Ω–∞–≥—Ä—É–∑–æ—á–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:

| –í—Ä–µ–º—è     | –ó–∞–ø—Ä–æ—Å–æ–≤/—Å–µ–∫ |
|-----------|-------------|
| 20:23:12  | 115         |
| 20:23:13  | 85          |
| 20:23:14  | 127         |
| 20:23:15  | 73          |
| 20:23:16  | 43          |
| 20:23:17  | 138         |
| 20:23:18  | 58          |
| 20:23:19  | 149         |
| 20:23:20  | 76          |
| 20:23:21  | 136         |
| 20:23:22  | 127         |
| 20:23:23  | 77          |
| 20:23:24  | **154**     |
| 20:23:25  | 83          |

**–ü–∏–∫–æ–≤–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** 154 –∑–∞–ø—Ä–æ—Å–∞/—Å–µ–∫  
**–°—Ä–µ–¥–Ω—è—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** 102 –∑–∞–ø—Ä–æ—Å–∞/—Å–µ–∫

## üõ† –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

- **–Ø–∑—ã–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è**: C++17
- **–°–±–æ—Ä–∫–∞**: CMake
- **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**: spdlog
- **HTTP-—Å–µ—Ä–≤–µ—Ä**: cpp-httplib
- **JSON**: nlohmann/json
- **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**: Google Test
- **–°–æ–∫–µ—Ç—ã**: –ë–µ—Ä–∫–ª–∏-—Å–æ–∫–µ—Ç—ã

## –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞
./run_server.sh

# –ó–∞–ø—É—Å–∫ –∫–ª–∏–µ–Ω—Ç–∞

## –£—Å–ø–µ—à–Ω—ã–π –∑–∞–ø—Ä–æ—Å
./run_client.sh 001010123456780

## –ó–∞–ø—Ä–æ—Å –∏–∑ —á–µ—Ä–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞
./run_client.sh 001010123456789

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ HTTP API

## –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –∞–±–æ–Ω–µ–Ω—Ç–∞
curl "http://localhost:8080/check_subscriber?imsi=001010123456780"

## –ò–Ω–∏—Ü–∏–∏—Ä–æ–≤–∞—Ç—å –æ—Å—Ç–∞–Ω–æ–≤–∫—É —Å–µ—Ä–≤–µ—Ä–∞
curl "http://localhost:8080/stop"

# üìà –ù–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

./load_test.sh

## –°–∫—Ä–∏–ø—Ç –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç:
- **2000 –∑–∞–ø—Ä–æ—Å–æ–≤**
- **50 –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π**
- **20% –∑–∞–ø—Ä–æ—Å–æ–≤ –∏–∑ —á–µ—Ä–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞**

# üìÑ –§–æ—Ä–º–∞—Ç—ã –¥–∞–Ω–Ω—ã—Ö

## UDP-–∑–∞–ø—Ä–æ—Å

<IMSI –≤ –≤–∏–¥–µ ASCII-—Å—Ç—Ä–æ–∫–∏>

–ü—Ä–∏–º–µ—Ä: 001010123456780

## UDP-–æ—Ç–≤–µ—Ç

    created - —Å–µ—Å—Å–∏—è —Å–æ–∑–¥–∞–Ω–∞
    rejected - —Å–µ—Å—Å–∏—è –æ—Ç–∫–ª–æ–Ω–µ–Ω–∞

## CDR-–∑–∞–ø–∏—Å—å

<timestamp>,<IMSI>,<action>

–ü—Ä–∏–º–µ—Ä:
2025-07-27 20:15:01,001010123456780,created
2025-07-27 20:15:02,001010123456789,rejected